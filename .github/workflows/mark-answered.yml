name: Mark Discussion as Answered

# Marks a discussion as answered when a maintainer comments /answered
# Only works for members, owners, and collaborators

on:
  discussion_comment:
    types: [created]

permissions:
  contents: read
  discussions: write

jobs:
  mark-answered:
    name: Mark Discussion as Answered
    runs-on: ubuntu-latest
    if: |
      github.event.action == 'created' && 
      contains(github.event.comment.body, '/answered') && 
      (github.event.comment.author_association == 'MEMBER' || 
       github.event.comment.author_association == 'OWNER' || 
       github.event.comment.author_association == 'COLLABORATOR')
    steps:
      - name: Mark discussion as answered
        uses: actions/github-script@v7
        with:
          script: |
            const discussion = context.payload.discussion;
            const commentId = context.payload.comment.id;
            
            try {
              // Mark the comment as the answer
              await github.rest.discussions.markAnswerComment({
                discussion_number: discussion.number,
                comment_number: commentId,
                owner: context.repo.owner,
                repo: context.repo.repo
              });
              
              // Mark the discussion as answered
              await github.rest.discussions.markAsAnswer({
                discussion_number: discussion.number,
                comment_number: commentId,
                owner: context.repo.owner,
                repo: context.repo.repo
              });
            } catch (error) {
              console.log('Could not mark as answered:', error.message);
            }

